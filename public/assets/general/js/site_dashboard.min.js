class SuperDashboard{constructor(e){this.apiBaseUrl=e,this.modalLoading=new Modal_loading,this.modalRealize=new ModalRealize("DashboardModalRealize"),this.modalConfirm=new ModalConfirm("DashboardModalConfirm")}getServerConnection(e,a=null,i=!0){i&&this.modalLoading.show();var n=new ServerConnection(this.apiBaseUrl);return n.setSubUrl("dashboard/"+e),n.setMethod("POST"),n.appendHeader("locale",locale),n.setOnFailed(function(e,i,n){var t=JSON.parse(e.responseText);if(this.modalRealize.setHeader(trans("result.failed")),"string"==typeof t.message)this.modalRealize.setBody(t.message);else{var o="";try{t.message.forEach((e=>{o+="* "+e+"\n"}))}catch(e){o=JSON.stringify(t.message,null,2)}this.modalRealize.setBody(o)}this.modalLoading.close(),this.modalRealize.create(),null!=a&&a(t)}.bind(this)),n}applyDefaultData(e){if(null!=e){var a=e.csrfToken;if(!func_isEmpty(a)){var i=document.getElementsByName("csrf-token");i.length>0&&((i=i[0]).content=a)}func_isEmpty(e.debugMode)||(this.debugMode=func_booleanValue(e.debugMode))}}}class DomainController extends SuperDashboard{constructor(e){super(e),this.bcPermenantDomain=func_getView("domain_bcPermenantDomainView").value,this.bcUnblockedDomain=func_getView("domain_bcUnblockedDomainView").value,this.domainIdView=func_getView("domainIdView"),this.setSiteUrls()}isDeviceVertical(){return screen.height>screen.width}setSiteUrls(){let e=func_getView("domain_bcPermenantUrlView"),a=func_getView("domain_bcUnblockedUrlView"),i="https://www."+this.bcPermenantDomain+"/fa",n="https://www."+this.bcUnblockedDomain+"/fa";this.isDeviceVertical()&&(i="https://m."+this.bcPermenantDomain+"/fa",n="https://m."+this.bcUnblockedDomain+"/fa"),e.href=i,e.innerHTML=i,a.href=n,a.innerHTML=n}copySiteUrlToClipboard(e){func_copyToClipboard(func_getView(e).href),showSuccessToast(func_getView("DomainCopiedMsg").value)}reportDomainIssue(){let e=this.modalConfirm;e.setHeader(trans("alert.Confirm")),e.setBody(func_getView("DomainReportConfirmMsg").value),e.create(),e.setOnYesPressed((()=>{var e=this.getServerConnection("domain/report_domain_issue");e.appendData("domainId",this.domainIdView.value),e.setOnSuccess(function(e){var a=JSON.parse(e),i=a.data,n=a.message;let t=func_getView("btnDomainReport");func_displayView(t.id,!1),func_getView("domainMsgView").innerHTML=n;let o=i.domainId;this.bcUnblockedDomain=i.bcUnblockedDomain,this.domainIdView.value=o,this.setSiteUrls(),this.applyDefaultData(i),this.modalLoading.close()}.bind(this)),e.connect()}))}}
